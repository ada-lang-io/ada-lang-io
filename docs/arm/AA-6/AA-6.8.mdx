---
sidebar_position:  58
---

# 6.8. Expression Functions

:::danger
This Reference Manual output has not been verified,
and may contain omissions or errors.
Report any problems on the [tracking issue](https://github.com/ada-lang-io/ada-lang-io/issues/20)
:::

import Admonition from "@theme/Admonition";
import AnnotatedOnly from "@site/src/components/AnnotatedOnly";
import CodeBlock from "@theme/CodeBlock";
import MarginText from "@site/src/components/MarginText";
import MarginInfo from "@site/src/components/MarginInfo";

<MarginText>1/3</MarginText>
<MarginInfo items={["AI05-0177-1"]} />
<p>An <code><a href="/docs/arm/AA-6/AA-6.8#S0228">expression_function_declaration</a></code> provides a shorthand to declare a function whose body consists of a single return statement. <br /></p>


#### Syntax

<MarginText>2/4</MarginText>
<MarginInfo items={["AI95-0177-1", "AI12-0157-1"]} />

<CodeBlock>
<code>expression{"_"}function{"_"}declaration</code><a id="S0228"></a><code> ::= </code><br />   [<code><a href="/docs/arm/AA-8/AA-8.3#S0234">overriding_indicator</a></code>]<br />   <code><a href="/docs/arm/AA-6/AA-6.1#S0198">function_specification</a></code> <b>is</b><br />       (<code><a href="/docs/arm/AA-4/AA-4.4#S0132">expression</a></code>)<br />       [<code><a href="/docs/arm/AA-13/AA-13.1#S0346">aspect_specification</a></code>];<br /> | [<code><a href="/docs/arm/AA-8/AA-8.3#S0234">overriding_indicator</a></code>]<br />   <code><a href="/docs/arm/AA-6/AA-6.1#S0198">function_specification</a></code> <b>is</b><br />       <code><a href="/docs/arm/AA-4/AA-4.3#S0106">aggregate</a></code><br />       [<code><a href="/docs/arm/AA-13/AA-13.1#S0346">aspect_specification</a></code>];<br />

</CodeBlock>

#### Name Resolution Rules

<MarginText>3/4</MarginText>
<MarginInfo items={["AI05-0177-1", "AI12-0157-1"]} />
<p>The expected type for the <code><a href="/docs/arm/AA-4/AA-4.4#S0132">expression</a></code> or <code><a href="/docs/arm/AA-4/AA-4.3#S0106">aggregate</a></code> of an <code><a href="/docs/arm/AA-6/AA-6.8#S0228">expression{"_"}function{"_"}declaration</a></code> is the result type (see <a href="/docs/arm/AA-6/AA-6.5">6.5</a>) of the function. <br /></p>


#### Static Semantics

<MarginText>3.1/5</MarginText>
<MarginInfo items={["AI05-0177-1", "AI05-0264-1", "AI12-0075-1", "AI12-0157-1", "AI12-0408-1"]} />
<p>An <code><a href="/docs/arm/AA-6/AA-6.8#S0228">expression{"_"}function{"_"}declaration</a></code> that is not a completion declares an <i>expression function</i>. The <i>return expression of an expression function</i> is the <code><a href="/docs/arm/AA-4/AA-4.4#S0132">expression</a></code> or <code><a href="/docs/arm/AA-4/AA-4.3#S0106">aggregate</a></code> of the <code><a href="/docs/arm/AA-6/AA-6.8#S0228">expression_function_declaration</a></code>. A completion is not allowed for an <code><a href="/docs/arm/AA-6/AA-6.8#S0228">expression{"_"}function{"_"}declaration</a></code>; however, an <code><a href="/docs/arm/AA-6/AA-6.8#S0228">expression{"_"}function{"_"}declaration</a></code> can complete a previous declaration.<br /></p>

<MarginText>3.2/5</MarginText>
<MarginInfo items={["AI12-0075-1"]} />
<p>A <i>potentially static expression</i> is defined in the same way as a static expression except that<br /></p>

<MarginText>3.3/5</MarginText>
<ul>
<li>a name denoting a formal parameter of an expression function is a potentially static expression; and<br /></li>
<MarginText>3.4/5</MarginText>
<li>each use of &ldquo;static expression&rdquo; in the definition of &ldquo;static expression&rdquo; is replaced with a corresponding use of &ldquo;potentially static expression&rdquo; in the definition of &ldquo;potentially static expression&rdquo;. <br /></li>
</ul>
<AnnotatedOnly>
<MarginText>3.a/5</MarginText>
<Admonition type="aarm" aarm="discussion">
<b></b>These uses occur in the definition of &ldquo;static expression&rdquo; in the cases of function calls, type conversions, qualified expressions, membership tests, short circuit control forms, conditional expressions, and parenthesized expressions. <br />
</Admonition>
</AnnotatedOnly>

<MarginText>3.5/5</MarginText>
<MarginInfo items={["AI12-0075-1"]} />
<p>The following language-defined representation aspect may be specified for an expression function:<br /></p>

<MarginText>3.6/5</MarginText>
<dt><br/>Static</dt>
<dl>
<dd>The type of aspect Static is Boolean. When aspect Static is True for an expression function, the function is a <i>static expression function</i>. If directly specified, the <code><a href="/docs/arm/AA-13/AA-13.1#S0348">aspect_definition</a></code> shall be a static expression.<br /></dd>
</dl>
<AnnotatedOnly>
<MarginText>3.b/5</MarginText>
<Admonition type="aarm" aarm="note">
<b>Aspect Description for </b><b>Static: </b>Specifies that an associated expression function can be used in static expressions.<br />
</Admonition>
</AnnotatedOnly>

<MarginText>3.7/5</MarginText>
<dt><br/></dt>
<dl>
<dd>The Static value for an inherited function is True if some corresponding primitive function of the parent or progenitor type is a static expression function; otherwise, if not directly specified, the aspect is False. <br /></dd>
</dl>
<MarginText>3.8/5</MarginText>
<MarginInfo items={["AI12-0075-1"]} />
<p>[A static expression function is a static function; see <a href="/docs/arm/AA-4/AA-4.9">4.9</a>.] <br /></p>


#### Legality Rules

<MarginText>4/3</MarginText>
<MarginInfo items={["AI05-0177-1"]} />
<p>If an <code><a href="/docs/arm/AA-6/AA-6.8#S0228">expression{"_"}function{"_"}declaration</a></code> is a completion, it shall be the completion of a <code><a href="/docs/arm/AA-6/AA-6.1#S0195">subprogram_declaration</a></code> or <code><a href="/docs/arm/AA-12/AA-12.1#S0311">generic_subprogram_declaration</a></code>. The profile of an <code><a href="/docs/arm/AA-6/AA-6.8#S0228">expression{"_"}function{"_"}declaration</a></code> that completes a declaration shall conform fully to that of the declaration.<br /></p>

<MarginText>5/4</MarginText>
<MarginInfo items={["AI05-0177-1", "AI12-0157-1"]} />
<p>If the result subtype has one or more unconstrained access discriminants, the accessibility level of the anonymous access type of each access discriminant, as determined by the <code><a href="/docs/arm/AA-4/AA-4.4#S0132">expression</a></code> or <code><a href="/docs/arm/AA-4/AA-4.3#S0106">aggregate</a></code> of the <code><a href="/docs/arm/AA-6/AA-6.8#S0228">expression{"_"}function{"_"}declaration</a></code>, shall not be statically deeper than that of the master that elaborated the <code><a href="/docs/arm/AA-6/AA-6.8#S0228">expression{"_"}function{"_"}declaration</a></code>.<br /></p>

<AnnotatedOnly>
<MarginText>5.a/3</MarginText>
<Admonition type="aarm" aarm="ramification">
<b></b>This can only fail if the discriminant is an access to a part of a nonaliased parameter, as there can be no local declarations here. <br />
</Admonition>
</AnnotatedOnly>

<AnnotatedOnly>
<MarginText>5.b/4</MarginText>
<MarginInfo items={["AI12-0005-1"]} />
<Admonition type="aarm" aarm="discussion">
<b></b>We don't need to repeat any of the other Legality Rules for return statements since none of them can fail here: the implicit return statement has to apply to this function (and isn't nested in something), there clearly is a return statement in this function, and the static class-wide accessibility check cannot fail as a tagged type cannot be declared locally in an expression function. <br />
</Admonition>
</AnnotatedOnly>

<MarginText>5.1/5</MarginText>
<MarginInfo items={["AI12-0075-1"]} />
<p>Aspect Static shall be specified to have the value True only if the associated <code><a href="/docs/arm/AA-6/AA-6.8#S0228">expression{"_"}function{"_"}declaration</a></code>:<br /></p>

<MarginText>5.2/5</MarginText>
<ul>
<li>is not a completion;<br /></li>
<MarginText>5.3/5</MarginText>
<li>has an <code><a href="/docs/arm/AA-4/AA-4.4#S0132">expression</a></code> that is a potentially static expression;<br /></li>
<MarginText>5.4/5</MarginText>
<li>contains no calls to itself;<br /></li>
<MarginText>5.5/5</MarginText>
<li>each parameter (if any) is of mode <b>in</b> and is of a static subtype;<br /></li>
<MarginText>5.6/5</MarginText>
<li>has a result subtype that is a static subtype;<br /></li>
<MarginText>5.7/5</MarginText>
<li>has no applicable precondition or postcondition expression; and<br /></li>
<MarginText>5.8/5</MarginText>
<MarginInfo items={["AI12-0075-1", "AI12-0191-1"]} />
<li>for result type <i>R</i>, if the function is a boundary entity for type <i>R</i> (see <a href="/docs/arm/AA-7/AA-7.3#Subclause_7.3.2">7.3.2</a>), no type invariant applies to type <i>R</i>; if <i>R</i> has a component type <i>C</i>, a similar rule applies to <i>C</i>. <br /></li>
</ul>
<AnnotatedOnly>
<MarginText>5.c/5</MarginText>
<Admonition type="aarm" aarm="ramification">
<b></b>Since a string subtype can be static, this allows an expression function of a string type to be static. <br />
</Admonition>
</AnnotatedOnly>

<p><i>Paragraph 6 was deleted.</i> <br /></p>


#### Dynamic Semantics

<MarginText>7/5</MarginText>
<MarginInfo items={["AI05-0177-1", "AI05-0262-1", "AI12-0157-1", "AI12-0408-1"]} />
<p>The execution of an expression function is invoked by a subprogram call. For the execution of a subprogram call on an expression function, or on a function completed with a <code><a href="/docs/arm/AA-6/AA-6.8#S0228">expression{"_"}function{"_"}declaration</a></code>, the execution of the <code><a href="/docs/arm/AA-6/AA-6.3#S0216">subprogram_body</a></code> executes an implicit function body containing only a <code><a href="/docs/arm/AA-6/AA-6.5#S0222">simple_return_statement</a></code> whose <code><a href="/docs/arm/AA-4/AA-4.4#S0132">expression</a></code> is the return expression of the expression function.<br /></p>

<AnnotatedOnly>
<MarginText>7.a/3</MarginText>
<Admonition type="aarm" aarm="discussion">
<b></b>The last sentence effectively means that all of the dynamic wording in <a href="/docs/arm/AA-6/AA-6.5">6.5</a> applies as needed, and we don't have to repeat it here. <br />
</Admonition>
</AnnotatedOnly>

<MarginText>8/3</MarginText>
<MarginInfo items={["AI05-0177-1"]} />
<p>The elaboration of an <code><a href="/docs/arm/AA-6/AA-6.8#S0228">expression{"_"}function{"_"}declaration</a></code> has no other effect than to establish that the expression function can be called without failing the Elaboration{"_"}Check. <br /></p>


#### Examples

<MarginText>9/5</MarginText>
<MarginInfo items={["AI12-0429-1"]} />
<p><i>Example of an expression function:</i> <br /></p>

<MarginText>10/3</MarginText>
<MarginInfo items={["AI05-0177-1"]} />
<CodeBlock language="ada">
function Is{"_"}Origin (P : in Point) return Boolean is -- see <a href="/docs/arm/AA-3/AA-3.9">3.9</a>{"\n"}   (P.X = 0.0 and P.Y = 0.0);{"\n"}

</CodeBlock>
<AnnotatedOnly>

#### Extensions to Ada 2005

</AnnotatedOnly>
<AnnotatedOnly>
<MarginText>10.a/3</MarginText>
<MarginInfo items={["AI05-0177-1"]} />
<Admonition type="aarm" aarm="note">
Expression functions are new in Ada 2012. <br />
</Admonition>
</AnnotatedOnly>

<AnnotatedOnly>

#### Extensions to Ada 2012

</AnnotatedOnly>
<AnnotatedOnly>
<MarginText>10.b/4</MarginText>
<MarginInfo items={["AI12-0157-1"]} />
<Admonition type="aarm" aarm="note">
<b>Corrigendum:</b> A <code><a href="/docs/arm/AA-4/AA-4.3#S0106">aggregate</a></code> can directly be the return expression of an expression function. This eliminates the double parentheses that otherwise would be necessary.<br />
</Admonition>
</AnnotatedOnly>

<AnnotatedOnly>
<MarginText>10.c/5</MarginText>
<MarginInfo items={["AI12-0075-1"]} />
<Admonition type="aarm" aarm="note">
Aspect Static is new; it allows using suitable expression functions in static expressions. <br />
</Admonition>
</AnnotatedOnly>

<AnnotatedOnly>

#### Wording Changes from Ada 2012

</AnnotatedOnly>
<AnnotatedOnly>
<MarginText>10.d/5</MarginText>
<MarginInfo items={["AI12-0408-1"]} />
<Admonition type="aarm" aarm="note">
Clarified the term &ldquo;expression function&rdquo; so it matches the meaning expected in <a href="/docs/arm/AA-6/AA-6.1">6.1</a>. <br />
</Admonition>
</AnnotatedOnly>


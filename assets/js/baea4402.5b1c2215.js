"use strict";(self.webpackChunkada_lang_io=self.webpackChunkada_lang_io||[]).push([[3544],{18861:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>m,contentTitle:()=>d,default:()=>u,frontMatter:()=>c,metadata:()=>h,toc:()=>p});var i=s(74848),a=s(28453),r=s(13842),t=s(91435),o=(s(21432),s(79162)),l=s(34421);const c={sidebar_position:147},d="C.1 Access to Machine Operations",h={id:"arm/AA-C/AA-C.1",title:"C.1 Access to Machine Operations",description:"This Reference Manual output has not been verified,",source:"@site/docs/arm/AA-C/AA-C.1.mdx",sourceDirName:"arm/AA-C",slug:"/arm/AA-C/AA-C.1",permalink:"/docs/arm/AA-C/AA-C.1",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:147,frontMatter:{sidebar_position:147},sidebar:"referenceManualSidebar",previous:{title:"Annex C Systems Programming",permalink:"/docs/arm/AA-C/"},next:{title:"C.2 Required Representation Support",permalink:"/docs/arm/AA-C/AA-C.2"}},m={},p=[{value:"Implementation Requirements",id:"implementation-requirements",level:4},{value:"Implementation Advice",id:"implementation-advice",level:4},{value:"Documentation Requirements",id:"documentation-requirements",level:4},{value:"Implementation Advice",id:"implementation-advice-1",level:4}];function x(e){const n={a:"a",admonition:"admonition",h1:"h1",h4:"h4",p:"p",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"c1-access-to-machine-operations",children:"C.1 Access to Machine Operations"}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsxs)(n.p,{children:["This Reference Manual output has not been verified,\nand may contain omissions or errors.\nReport any problems on the ",(0,i.jsx)(n.a,{href:"https://github.com/ada-lang-io/ada-lang-io/issues/20",children:"tracking issue"})]})}),"\n","\n","\n",(0,i.jsx)(o.A,{children:"1/3"}),"\n",(0,i.jsx)(l.A,{items:["AI05-0299-1"]}),"\n",(0,i.jsxs)("p",{children:["[This subclause specifies rules regarding access to machine instructions from within an Ada program.] ",(0,i.jsx)("br",{})]}),"\n",(0,i.jsxs)(t.A,{children:[(0,i.jsx)(o.A,{children:"1.a/2"}),(0,i.jsx)(r.A,{type:"aarm",aarm:"implementation-defined",children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)("strong",{}),"Implementation-defined intrinsic subprograms.",(0,i.jsx)("br",{})]})})]}),"\n",(0,i.jsx)(n.h4,{id:"implementation-requirements",children:"Implementation Requirements"}),"\n",(0,i.jsx)(o.A,{children:"2/5"}),"\n",(0,i.jsx)(l.A,{items:["AI12-0320-1"]}),"\n",(0,i.jsxs)("p",{children:["The implementation shall support machine code insertions (see ",(0,i.jsx)("a",{href:"../AA-13/AA-13.8",children:"13.8"}),") or intrinsic subprograms (see ",(0,i.jsx)("a",{href:"../AA-6/AA-6.3#Subclause_6.3.1",children:"6.3.1"}),") (or both). The implementation shall allow the use of Ada entities as operands for such machine code insertions or intrinsic subprograms.",(0,i.jsx)("br",{})]}),"\n",(0,i.jsxs)(t.A,{children:[(0,i.jsx)(o.A,{children:"2.a/5"}),(0,i.jsx)(l.A,{items:["AI12-0320-1"]}),(0,i.jsx)(r.A,{type:"aarm",aarm:"discussion",children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)("strong",{}),"Ada entities could be used as operands in machine code insertions and/or intrinsic subprograms using language-defined attributes (such as address), implementation-defined attributes, or could be directly allowed. ",(0,i.jsx)("br",{})]})})]}),"\n",(0,i.jsx)(n.h4,{id:"implementation-advice",children:"Implementation Advice"}),"\n",(0,i.jsx)(o.A,{children:"3"}),"\n",(0,i.jsxs)("p",{children:["The machine code or intrinsics support should allow access to all operations normally available to assembly language programmers for the target environment, including privileged instructions, if any. ",(0,i.jsx)("br",{})]}),"\n",(0,i.jsxs)(t.A,{children:[(0,i.jsx)(o.A,{children:"3.a.1/2"}),(0,i.jsx)(r.A,{type:"aarm",aarm:"implementation-advice",children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)("strong",{}),"The machine code or intrinsics support should allow access to all operations normally available to assembly language programmers for the target environment.",(0,i.jsx)("br",{})]})})]}),"\n",(0,i.jsxs)(t.A,{children:[(0,i.jsx)(o.A,{children:"3.a"}),(0,i.jsx)(r.A,{type:"aarm",aarm:"ramification",children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)("strong",{}),"Of course, on a machine with protection, an attempt to execute a privileged instruction in user mode will probably trap. Nonetheless, we want implementations to provide access to them so that Ada can be used to write systems programs that run in privileged mode. ",(0,i.jsx)("br",{})]})})]}),"\n",(0,i.jsx)(o.A,{children:"4/3"}),"\n",(0,i.jsx)(l.A,{items:["AI05-0229-1"]}),"\n",(0,i.jsxs)("p",{children:["The support for interfacing aspects (see ",(0,i.jsx)("a",{href:"../AA-B/",children:"Annex B"}),") should include interface to assembler; the default assembler should be associated with the convention identifier Assembler. ",(0,i.jsx)("br",{})]}),"\n",(0,i.jsxs)(t.A,{children:[(0,i.jsx)(o.A,{children:"4.a/2"}),(0,i.jsx)(r.A,{type:"aarm",aarm:"implementation-advice",children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)("strong",{}),"Interface to assembler should be supported; the default assembler should be associated with the convention identifier Assembler.",(0,i.jsx)("br",{})]})})]}),"\n",(0,i.jsx)(o.A,{children:"5"}),"\n",(0,i.jsxs)("p",{children:["If an entity is exported to assembly language, then the implementation should allocate it at an addressable location, and should ensure that it is retained by the linking process, even if not otherwise referenced from the Ada code. The implementation should assume that any call to a machine code or assembler subprogram is allowed to read or update every object that is specified as exported. ",(0,i.jsx)("br",{})]}),"\n",(0,i.jsxs)(t.A,{children:[(0,i.jsx)(o.A,{children:"5.a/5"}),(0,i.jsx)(r.A,{type:"aarm",aarm:"implementation-advice",children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)("strong",{}),"If an entity is exported to assembly language, then the implementation should allocate it at an addressable location even if not otherwise referenced from the Ada code. A call to a machine code or assembler subprogram should be treated as if it can read or update every object that is specified as exported.",(0,i.jsx)("br",{})]})})]}),"\n",(0,i.jsx)(n.h4,{id:"documentation-requirements",children:"Documentation Requirements"}),"\n",(0,i.jsx)(o.A,{children:"6"}),"\n",(0,i.jsxs)("p",{children:["The implementation shall document the overhead associated with calling machine-code or intrinsic subprograms, as compared to a fully-inlined call, and to a regular out-of-line call. ",(0,i.jsx)("br",{})]}),"\n",(0,i.jsxs)(t.A,{children:[(0,i.jsx)(o.A,{children:"6.a/2"}),(0,i.jsx)(r.A,{type:"aarm",aarm:"note",children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)("strong",{children:"Documentation Requirement: "}),"The overhead of calling machine-code or intrinsic subprograms.",(0,i.jsx)("br",{})]})})]}),"\n",(0,i.jsx)(o.A,{children:"7"}),"\n",(0,i.jsxs)("p",{children:["The implementation shall document the types of the package System.Machine","_","Code usable for machine code insertions, and the attributes to be used in machine code insertions for references to Ada entities. ",(0,i.jsx)("br",{})]}),"\n",(0,i.jsxs)(t.A,{children:[(0,i.jsx)(o.A,{children:"7.a/2"}),(0,i.jsx)(r.A,{type:"aarm",aarm:"note",children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)("strong",{children:"Documentation Requirement: "}),"The types and attributes used in machine code insertions.",(0,i.jsx)("br",{})]})})]}),"\n",(0,i.jsx)(o.A,{children:"8/3"}),"\n",(0,i.jsx)(l.A,{items:["AI05-0229-1"]}),"\n",(0,i.jsxs)("p",{children:["The implementation shall document the subprogram calling conventions associated with the convention identifiers available for use with the Convention aspect (Ada and Assembler, at a minimum), including register saving, exception propagation, parameter passing, and function value returning. ",(0,i.jsx)("br",{})]}),"\n",(0,i.jsxs)(t.A,{children:[(0,i.jsx)(o.A,{children:"8.a/2"}),(0,i.jsx)(r.A,{type:"aarm",aarm:"note",children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)("strong",{children:"Documentation Requirement: "}),"The subprogram calling conventions for all supported convention identifiers.",(0,i.jsx)("br",{})]})})]}),"\n",(0,i.jsx)(o.A,{children:"9"}),"\n",(0,i.jsxs)("p",{children:["For exported and imported subprograms, the implementation shall document the mapping between the Link","_","Name string, if specified, or the Ada designator, if not, and the external link name used for such a subprogram. ",(0,i.jsx)("br",{})]}),"\n",(0,i.jsxs)(t.A,{children:[(0,i.jsx)(o.A,{children:"9.a/2"}),(0,i.jsxs)(r.A,{type:"aarm",aarm:"note",children:[(0,i.jsx)("em",{children:"This paragraph was deleted."}),(0,i.jsx)("br",{})]})]}),"\n",(0,i.jsxs)(t.A,{children:[(0,i.jsx)(o.A,{children:"9.b/2"}),(0,i.jsx)(r.A,{type:"aarm",aarm:"note",children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)("strong",{children:"Documentation Requirement: "}),"The mapping between the Link","_","Name or Ada designator and the external link name.",(0,i.jsx)("br",{})]})})]}),"\n",(0,i.jsx)(n.h4,{id:"implementation-advice-1",children:"Implementation Advice"}),"\n",(0,i.jsx)(o.A,{children:"10"}),"\n",(0,i.jsxs)("p",{children:["The implementation should ensure that little or no overhead is associated with calling intrinsic and machine-code subprograms. ",(0,i.jsx)("br",{})]}),"\n",(0,i.jsxs)(t.A,{children:[(0,i.jsx)(o.A,{children:"10.a/2"}),(0,i.jsx)(r.A,{type:"aarm",aarm:"implementation-advice",children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)("strong",{}),"Little or no overhead should be associated with calling intrinsic and machine-code subprograms.",(0,i.jsx)("br",{})]})})]}),"\n",(0,i.jsx)(o.A,{children:"11"}),"\n",(0,i.jsxs)("p",{children:["It is recommended that intrinsic subprograms be provided for convenient access to any machine operations that provide special capabilities or efficiency and that are not otherwise available through the language constructs. Examples of such instructions include: ",(0,i.jsx)("br",{})]}),"\n",(0,i.jsx)(o.A,{children:"12/5"}),"\n",(0,i.jsx)(l.A,{items:["AI12-0453-1"]}),"\n",(0,i.jsxs)("ul",{children:[(0,i.jsxs)("li",{children:["Atomic read-modify-write operations \u2014 for example, test and set, compare and swap, decrement and test, enqueue/dequeue.",(0,i.jsx)("br",{})]}),(0,i.jsx)(o.A,{children:"13/5"}),(0,i.jsx)(l.A,{items:["AI12-0453-1"]}),(0,i.jsxs)("li",{children:["Standard numeric functions \u2014 for example, ",(0,i.jsx)("em",{children:"sin"}),", ",(0,i.jsx)("em",{children:"log"}),".",(0,i.jsx)("br",{})]}),(0,i.jsx)(o.A,{children:"14/5"}),(0,i.jsx)(l.A,{items:["AI12-0453-1"]}),(0,i.jsxs)("li",{children:["String manipulation operations \u2014 for example, translate and test.",(0,i.jsx)("br",{})]}),(0,i.jsx)(o.A,{children:"15/5"}),(0,i.jsx)(l.A,{items:["AI12-0453-1"]}),(0,i.jsxs)("li",{children:["Vector operations \u2014 for example, compare vector against thresholds.",(0,i.jsx)("br",{})]}),(0,i.jsx)(o.A,{children:"16"}),(0,i.jsxs)("li",{children:["Direct operations on I/O ports.",(0,i.jsx)("br",{})]})]}),"\n",(0,i.jsxs)(t.A,{children:[(0,i.jsx)(o.A,{children:"16.a/2"}),(0,i.jsx)(r.A,{type:"aarm",aarm:"implementation-advice",children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)("strong",{}),"Intrinsic subprograms should be provided to access any machine operations that provide special capabilities or efficiency not normally available.",(0,i.jsx)("br",{})]})})]})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(x,{...e})}):x(e)}}}]);
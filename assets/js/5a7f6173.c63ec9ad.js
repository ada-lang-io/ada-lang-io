"use strict";(self.webpackChunkada_lang_io=self.webpackChunkada_lang_io||[]).push([[7535],{6819:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>x,contentTitle:()=>A,default:()=>f,frontMatter:()=>h,metadata:()=>a,toc:()=>j});const a=JSON.parse('{"id":"arm/AA-9/AA-9.3","title":"9.3. Task Dependence - Termination of Tasks","description":"This Reference Manual output has not been verified,","source":"@site/docs/arm/AA-9/AA-9.3.mdx","sourceDirName":"arm/AA-9","slug":"/arm/AA-9/AA-9.3","permalink":"/docs/arm/AA-9/AA-9.3","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":76,"frontMatter":{"sidebar_position":76},"sidebar":"referenceManualSidebar","previous":{"title":"9.2. Task Execution - Task Activation","permalink":"/docs/arm/AA-9/AA-9.2"},"next":{"title":"9.4. Protected Units and Protected Objects","permalink":"/docs/arm/AA-9/AA-9.4"}}');var r=s(4848),i=s(8453),t=s(3204),d=s(4220),c=s(8069),o=s(8011),l=s(6465);const h={sidebar_position:76},A="9.3. Task Dependence - Termination of Tasks",x={},j=[{value:"Dynamic Semantics",id:"dynamic-semantics",level:4},{value:"Examples",id:"examples",level:4},{value:"Wording Changes from Ada 83",id:"wording-changes-from-ada-83",level:4},{value:"Wording Changes from Ada 95",id:"wording-changes-from-ada-95",level:4},{value:"Wording Changes from Ada 2012",id:"wording-changes-from-ada-2012",level:4}];function m(e){const n={a:"a",admonition:"admonition",h1:"h1",h4:"h4",header:"header",p:"p",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"93-task-dependence---termination-of-tasks",children:"9.3. Task Dependence - Termination of Tasks"})}),"\n",(0,r.jsx)(n.admonition,{type:"danger",children:(0,r.jsxs)(n.p,{children:["This Reference Manual output has not been verified,\nand may contain omissions or errors.\nReport any problems on the ",(0,r.jsx)(n.a,{href:"https://github.com/ada-lang-io/ada-lang-io/issues/20",children:"tracking issue"})]})}),"\n","\n",(0,r.jsx)(n.h4,{id:"dynamic-semantics",children:"Dynamic Semantics"}),"\n",(0,r.jsx)(o.A,{children:"1"}),"\n",(0,r.jsxs)("p",{children:["Each task (other than an environment task \u2014 see ",(0,r.jsx)("a",{href:"/docs/arm/AA-10/AA-10.2",children:"10.2"}),") ",(0,r.jsx)("i",{children:"depends"})," on one or more masters (see ",(0,r.jsx)("a",{href:"/docs/arm/AA-7/AA-7.6#Subclause_7.6.1",children:"7.6.1"}),"), as follows: ",(0,r.jsx)("br",{})]}),"\n",(0,r.jsx)(o.A,{children:"2/4"}),"\n",(0,r.jsx)(l.A,{items:["AI12-0070-1"]}),"\n",(0,r.jsxs)("ul",{children:[(0,r.jsxs)("li",{children:["If the task is created by the evaluation of an ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-4/AA-4.8#S0164",children:"allocator"})})," for a given named access type, it depends on each master that includes the elaboration of the declaration of the ultimate ancestor of the given access type.",(0,r.jsx)("br",{})]}),(0,r.jsx)(o.A,{children:"3"}),(0,r.jsxs)("li",{children:["If the task is created by the elaboration of an ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-3/AA-3.3#S0032",children:"object_declaration"})}),", it depends on each master that includes this elaboration.",(0,r.jsx)("br",{})]}),(0,r.jsx)(o.A,{children:"3.1/2"}),(0,r.jsx)(l.A,{items:["AI95-00416-01"]}),(0,r.jsxs)("li",{children:["Otherwise, the task depends on the master of the outermost object of which it is a part (as determined by the accessibility level of that object \u2014 see ",(0,r.jsx)("a",{href:"/docs/arm/AA-3/AA-3.10#Subclause_3.10.2",children:"3.10.2"})," and ",(0,r.jsx)("a",{href:"/docs/arm/AA-7/AA-7.6#Subclause_7.6.1",children:"7.6.1"}),"), as well as on any master whose execution includes that of the master of the outermost object. ",(0,r.jsx)("br",{})]})]}),"\n",(0,r.jsxs)(d.A,{children:[(0,r.jsx)(o.A,{children:"3.a/2"}),(0,r.jsx)(l.A,{items:["AI95-00416-01"]}),(0,r.jsx)(t.A,{type:"aarm",aarm:"ramification",children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)("b",{}),"The master of a task created by a return statement changes when the accessibility of the return object changes. Note that its activation happens, if at all, only after the function returns and all accessibility level changes have occurred. ",(0,r.jsx)("br",{})]})})]}),"\n",(0,r.jsx)(o.A,{children:"4"}),"\n",(0,r.jsxs)("p",{children:["Furthermore, if a task depends on a given master, it is defined to depend on the task that executes the master, and (recursively) on any master of that task. ",(0,r.jsx)("br",{})]}),"\n",(0,r.jsxs)(d.A,{children:[(0,r.jsx)(o.A,{children:"4.a"}),(0,r.jsx)(t.A,{type:"aarm",aarm:"discussion",children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)("b",{}),"Don't confuse these kinds of dependences with the dependences among compilation units defined in ",(0,r.jsx)("a",{href:"/docs/arm/AA-10/AA-10.1#Subclause_10.1.1",children:"10.1.1"}),", \u201c",(0,r.jsx)("a",{href:"/docs/arm/AA-10/AA-10.1#Subclause_10.1.1",children:"Compilation Units - Library Units"}),"\u201d. ",(0,r.jsx)("br",{})]})})]}),"\n",(0,r.jsx)(o.A,{children:"5"}),"\n",(0,r.jsxs)("p",{children:["A task is said to be ",(0,r.jsx)("i",{children:"completed"})," when the execution of its corresponding ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-9/AA-9.1#S0248",children:"task_body"})})," is completed. A task is said to be ",(0,r.jsx)("i",{children:"terminated"})," when any finalization of the ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-9/AA-9.1#S0248",children:"task_body"})})," has been performed (see ",(0,r.jsx)("a",{href:"/docs/arm/AA-7/AA-7.6#Subclause_7.6.1",children:"7.6.1"}),"). [The first step of finalizing a master (including a ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-9/AA-9.1#S0248",children:"task_body"})}),") is to wait for the termination of any tasks dependent on the master.] The task executing the master is blocked until all the dependents have terminated. [Any remaining finalization is then performed and the master is left.]",(0,r.jsx)("br",{})]}),"\n",(0,r.jsx)(o.A,{children:"6/1"}),"\n",(0,r.jsxs)("p",{children:["Completion of a task (and the corresponding ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-9/AA-9.1#S0248",children:"task_body"})}),") can occur when the task is blocked at a ",(0,r.jsx)("code",{children:(0,r.jsxs)("a",{href:"/docs/arm/AA-9/AA-9.7#S0269",children:["select","_","statement"]})})," with an open ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-9/AA-9.7#S0275",children:"terminate_alternative"})})," (see ",(0,r.jsx)("a",{href:"/docs/arm/AA-9/AA-9.7#Subclause_9.7.1",children:"9.7.1"}),"); the open ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-9/AA-9.7#S0275",children:"terminate_alternative"})})," is selected if and only if the following conditions are satisfied: ",(0,r.jsx)("br",{})]}),"\n",(0,r.jsx)(o.A,{children:"7/2"}),"\n",(0,r.jsx)(l.A,{items:["AI95-00415-01"]}),"\n",(0,r.jsxs)("ul",{children:[(0,r.jsxs)("li",{children:["The task depends on some completed master; and",(0,r.jsx)("br",{})]}),(0,r.jsx)(o.A,{children:"8"}),(0,r.jsxs)("li",{children:["Each task that depends on the master considered is either already terminated or similarly blocked at a ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-9/AA-9.7#S0269",children:"select_statement"})})," with an open ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-9/AA-9.7#S0275",children:"terminate_alternative"})}),". ",(0,r.jsx)("br",{})]})]}),"\n",(0,r.jsx)(o.A,{children:"9"}),"\n",(0,r.jsxs)("p",{children:["When both conditions are satisfied, the task considered becomes completed, together with all tasks that depend on the master considered that are not yet completed. ",(0,r.jsx)("br",{})]}),"\n",(0,r.jsxs)(d.A,{children:[(0,r.jsx)(o.A,{children:"9.a"}),(0,r.jsx)(t.A,{type:"aarm",aarm:"ramification",children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)("b",{}),"Any required finalization is performed after the selection of ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-9/AA-9.7#S0275",children:"terminate_alternative"})}),"s. The tasks are not callable during the finalization. In some ways it is as though they were aborted. ",(0,r.jsx)("br",{})]})})]}),"\n",(0,r.jsxs)(d.A,{children:[(0,r.jsx)(o.A,{children:"10"}),(0,r.jsx)(t.A,{type:"aarm",aarm:"note",children:(0,r.jsxs)(n.p,{children:["NOTE 1   The full view of a limited private type can be a task type, or can have subcomponents of a task type. Creation of an object of such a type creates dependences according to the full type.",(0,r.jsx)("br",{})]})})]}),"\n",(0,r.jsxs)(d.A,{children:[(0,r.jsx)(o.A,{children:"11"}),(0,r.jsx)(t.A,{type:"aarm",aarm:"note",children:(0,r.jsxs)(n.p,{children:["NOTE 2   An ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-8/AA-8.5#S0239",children:"object_renaming_declaration"})})," defines a new view of an existing entity and hence creates no further dependence.",(0,r.jsx)("br",{})]})})]}),"\n",(0,r.jsxs)(d.A,{children:[(0,r.jsx)(o.A,{children:"12/5"}),(0,r.jsx)(l.A,{items:["AI12-0440-1"]}),(0,r.jsx)(t.A,{type:"aarm",aarm:"note",children:(0,r.jsxs)(n.p,{children:["NOTE 3   The rules given for the collective completion of a group of tasks all blocked on ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-9/AA-9.7#S0269",children:"select_statement"})}),"s with open ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-9/AA-9.7#S0275",children:"terminate_alternative"})}),"s ensure that the collective completion can occur only when there are no remaining active tasks that can call one of the tasks being collectively completed.",(0,r.jsx)("br",{})]})})]}),"\n",(0,r.jsxs)(d.A,{children:[(0,r.jsx)(o.A,{children:"13"}),(0,r.jsx)(t.A,{type:"aarm",aarm:"note",children:(0,r.jsxs)(n.p,{children:["NOTE 4   If two or more tasks are blocked on ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-9/AA-9.7#S0269",children:"select_statement"})}),"s with open ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-9/AA-9.7#S0275",children:"terminate_alternative"})}),"s, and become completed collectively, their finalization actions proceed concurrently.",(0,r.jsx)("br",{})]})})]}),"\n",(0,r.jsxs)(d.A,{children:[(0,r.jsx)(o.A,{children:"14"}),(0,r.jsx)(t.A,{type:"aarm",aarm:"note",children:(0,r.jsxs)(n.p,{children:["NOTE 5   The completion of a task can occur due to any of the following: ",(0,r.jsx)("br",{})]})})]}),"\n",(0,r.jsxs)(d.A,{children:[(0,r.jsx)(o.A,{children:"15"}),(0,r.jsxs)("ul",{children:[(0,r.jsxs)("li",{children:["the raising of an exception during the elaboration of the ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-3/AA-3.11#S0086",children:"declarative_part"})})," of the corresponding ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-9/AA-9.1#S0248",children:"task_body"})}),";",(0,r.jsx)("br",{})]}),(0,r.jsx)(o.A,{children:"16"}),(0,r.jsxs)("li",{children:["the completion of the ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-11/AA-11.2#S0304",children:"handled_sequence_of_statements"})})," of the corresponding ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-9/AA-9.1#S0248",children:"task_body"})}),";",(0,r.jsx)("br",{})]}),(0,r.jsx)(o.A,{children:"17"}),(0,r.jsxs)("li",{children:["the selection of an open ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-9/AA-9.7#S0275",children:"terminate_alternative"})})," of a ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-9/AA-9.7#S0269",children:"select_statement"})})," in the corresponding ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-9/AA-9.1#S0248",children:"task_body"})}),";",(0,r.jsx)("br",{})]}),(0,r.jsx)(o.A,{children:"18"}),(0,r.jsxs)("li",{children:["the abort of the task. ",(0,r.jsx)("br",{})]})]})]}),"\n",(0,r.jsx)(n.h4,{id:"examples",children:"Examples"}),"\n",(0,r.jsx)(o.A,{children:"19"}),"\n",(0,r.jsxs)("p",{children:[(0,r.jsx)("i",{children:"Example of task dependence:"})," ",(0,r.jsx)("br",{})]}),"\n",(0,r.jsx)(o.A,{children:"20"}),"\n",(0,r.jsx)(c.A,{language:"ada",children:(0,r.jsxs)(n.p,{children:["declare","\n","   type Global is access Server;        --  see ",(0,r.jsx)("a",{href:"/docs/arm/AA-9/AA-9.1",children:"9.1"}),"\n","   A, B : Server;","\n","   G    : Global;","\n","begin","\n","   --  activation of A and B","\n","   declare","\n","      type Local is access Server;","\n","      X : Global := new Server;  --  activation of X.all","\n","      L : Local  := new Server;  --  activation of L.all","\n","      C : Server;","\n","   begin","\n","      --  activation of C","\n","      G := X;  --  both G and X designate the same task object","\n","      ...","\n","   end;  --  await termination of C and L.all (but not X.all)","\n","   ...","\n","end;  --  await termination of A, B, and G.all","\n"]})}),"\n",(0,r.jsx)(d.A,{children:(0,r.jsx)(n.h4,{id:"wording-changes-from-ada-83",children:"Wording Changes from Ada 83"})}),"\n",(0,r.jsxs)(d.A,{children:[(0,r.jsx)(o.A,{children:"20.a"}),(0,r.jsx)(t.A,{type:"aarm",aarm:"note",children:(0,r.jsxs)(n.p,{children:["We have revised the wording to be consistent with the definition of master now given in ",(0,r.jsx)("a",{href:"/docs/arm/AA-7/AA-7.6#Subclause_7.6.1",children:"7.6.1"}),", \u201c",(0,r.jsx)("a",{href:"/docs/arm/AA-7/AA-7.6#Subclause_7.6.1",children:"Completion and Finalization"}),"\u201d.",(0,r.jsx)("br",{})]})})]}),"\n",(0,r.jsxs)(d.A,{children:[(0,r.jsx)(o.A,{children:"20.b"}),(0,r.jsx)(t.A,{type:"aarm",aarm:"note",children:(0,r.jsxs)(n.p,{children:["Tasks that used to depend on library packages in Ada 83, now depend on the (implicit) ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-9/AA-9.1#S0248",children:"task_body"})})," of the environment task (see ",(0,r.jsx)("a",{href:"/docs/arm/AA-10/AA-10.2",children:"10.2"}),"). Therefore, the environment task has to wait for them before performing library level finalization and terminating the partition. In Ada 83 the requirement to wait for tasks that depended on library packages was not as clear.",(0,r.jsx)("br",{})]})})]}),"\n",(0,r.jsxs)(d.A,{children:[(0,r.jsx)(o.A,{children:"20.c"}),(0,r.jsx)(t.A,{type:"aarm",aarm:"note",children:(0,r.jsxs)(n.p,{children:['What was "collective termination" is now "collective completion" resulting from selecting ',(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-9/AA-9.7#S0275",children:"terminate_alternative"})}),"s. This is because finalization still occurs for such tasks, and this happens after selecting the ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-9/AA-9.7#S0275",children:"terminate_alternative"})}),", but before termination. ",(0,r.jsx)("br",{})]})})]}),"\n",(0,r.jsx)(d.A,{children:(0,r.jsx)(n.h4,{id:"wording-changes-from-ada-95",children:"Wording Changes from Ada 95"})}),"\n",(0,r.jsxs)(d.A,{children:[(0,r.jsx)(o.A,{children:"20.d/2"}),(0,r.jsx)(l.A,{items:["AI95-00416-01"]}),(0,r.jsx)(t.A,{type:"aarm",aarm:"note",children:(0,r.jsxs)(n.p,{children:["Added missing wording that explained the master of tasks that are neither ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-3/AA-3.3#S0032",children:"object_declaration"})}),"s nor ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-4/AA-4.8#S0164",children:"allocator"})}),"s, such as function returns. ",(0,r.jsx)("br",{})]})})]}),"\n",(0,r.jsx)(d.A,{children:(0,r.jsx)(n.h4,{id:"wording-changes-from-ada-2012",children:"Wording Changes from Ada 2012"})}),"\n",(0,r.jsxs)(d.A,{children:[(0,r.jsx)(o.A,{children:"20.e/4"}),(0,r.jsx)(l.A,{items:["AI12-0070-1"]}),(0,r.jsx)(t.A,{type:"aarm",aarm:"note",children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)("b",{children:"Corrigendum:"})," Ensured that the master of tasks that are not ",(0,r.jsx)("code",{children:(0,r.jsx)("a",{href:"/docs/arm/AA-4/AA-4.8#S0164",children:"allocator"})}),"s of named access types is correctly determined. (Ignoring the accessibility rules of ",(0,r.jsx)("a",{href:"/docs/arm/AA-3/AA-3.10#Subclause_3.10.2",children:"3.10.2"})," could not be intended.) ",(0,r.jsx)("br",{})]})})]})]})}function f(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(m,{...e})}):m(e)}}}]);